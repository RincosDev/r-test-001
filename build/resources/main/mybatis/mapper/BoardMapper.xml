<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="com.rtest.mapper.BoardMapper">
    
    <!-- 게시글 목록 조회 -->
    <select id="selectBoardList" resultType="com.rtest.vo.BoardVO">
        SELECT 
            BOARD_NO AS boardNo,
            TITLE AS title,
            WRITER AS writer,
            TO_CHAR(REG_DATE, 'YYYY-MM-DD HH24:MI:SS') AS regDate,
            VIEW_COUNT AS viewCount
        FROM TB_BOARD
        ORDER BY BOARD_NO DESC
    </select>
    
    <!-- 게시글 상세 조회 -->
    <select id="selectBoard" parameterType="Long" resultType="com.rtest.vo.BoardVO">
        SELECT 
            BOARD_NO AS boardNo,
            TITLE AS title,
            CONTENT AS content,
            WRITER AS writer,
            TO_CHAR(REG_DATE, 'YYYY-MM-DD HH24:MI:SS') AS regDate,
            TO_CHAR(MOD_DATE, 'YYYY-MM-DD HH24:MI:SS') AS modDate,
            VIEW_COUNT AS viewCount
        FROM TB_BOARD
        WHERE BOARD_NO = #{boardNo}
    </select>
    
    <!-- 게시글 등록 -->
    <insert id="insertBoard" parameterType="com.rtest.vo.BoardVO">
        INSERT INTO TB_BOARD (
            BOARD_NO,
            TITLE,
            CONTENT,
            WRITER,
            REG_DATE,
            MOD_DATE
        ) VALUES (
            SEQ_BOARD_NO.NEXTVAL,
            #{title},
            #{content},
            #{writer},
            SYSDATE,
            SYSDATE
        )
    </insert>
    
    <!-- 게시글 수정 -->
    <update id="updateBoard" parameterType="com.rtest.vo.BoardVO">
        UPDATE TB_BOARD
        SET TITLE = #{title},
            CONTENT = #{content},
            MOD_DATE = SYSDATE
        WHERE BOARD_NO = #{boardNo}
    </update>
    
    <!-- 게시글 삭제 -->
    <delete id="deleteBoard" parameterType="Long">
        DELETE FROM TB_BOARD
        WHERE BOARD_NO = #{boardNo}
    </delete>
    
    <!-- 조회수 증가 -->
    <update id="increaseViewCount" parameterType="Long">
        UPDATE TB_BOARD
        SET VIEW_COUNT = VIEW_COUNT + 1
        WHERE BOARD_NO = #{boardNo}
    </update>
    
</mapper>
